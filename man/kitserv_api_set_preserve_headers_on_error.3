.Dd December 11, 2023
.Dt kitserv_api_set_preserve_headers_on_error 3
.Nm kitserv_api_set_preserve_headers_on_error(3)
.Sh SYNOPSIS
.Pp
.Lb kitserv
.Pp
.In kitserv.h
.Pp
.Ft void
.Fn kitserv_api_set_preserve_headers_on_error "struct kitserv_client*" "bool preserve_enabled"
.Sh DESCRIPTION
The
.Sy kitserv_api_set_preserve_headers_on_error()
function instructs Kitserv not to discard headers when returning an error
response to the client.
.Pp
Normally, when an error response is generated, Kitserv wipes out both the
headers and body of the response to create a canned response. However, if
the endpoint so wishes, they may use
.Sy kitserv_api_set_preserve_headers_on_error()
and
.Sy kitserv_api_set_preserve_body_on_error()
to override the response sent. For example, this could be used to include
a custom warning message on a 403 response.
.Pp
If the body is preserved, the headers are also preserved. This is to facilitate
setting the content-type header for the body that the endpoint has prepared.
.Pp
Note that, if the body is discarded but the headers are not, a content-type
header will be added. So, do not add this header in the endpoint as it will
conflict with the Kitserv header. This is in addition to headers already
automatically added by Kitserv. See
.Sy kitserv(0)
for more information.
.Sh COPYRIGHT
.Pp
Copyright (c) 2023 Jmcgee1125.
.Pp
Kitserv is licensed under the GNU Affero GPL v3. You are free to redistribute
and modify this code as you see fit, provided that you make the source code
freely available under these terms.
